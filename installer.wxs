<?xml version="1.0" encoding="UTF-8"?>
<!-- 
    WiX Installer Configuration for Background Remover
    المهندس حمزة ضمرة - Eng. Hamza Damra
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Id="*" 
             Name="Background Remover Pro" 
             Language="1033" 
             Version="1.0.0.0" 
             Manufacturer="Hamza Damra" 
             UpgradeCode="12345678-1234-1234-1234-123456789012">
        
        <Package InstallerVersion="200" 
                 Compressed="yes" 
                 InstallScope="perMachine" 
                 Description="Background Remover Pro - AI-Powered Background Removal"
                 Comments="Developed by Eng. Hamza Damra" />

        <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
        
        <MediaTemplate EmbedCab="yes" />

        <!-- Icons -->
        <Icon Id="icon.ico" SourceFile="bgremover\app\ui\assets\icon.ico"/>
        <Property Id="ARPPRODUCTICON" Value="icon.ico" />
        
        <!-- Properties -->
        <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />
        <Property Id="ARPHELPLINK" Value="https://github.com/hamzadamra" />
        <Property Id="ARPCONTACT" Value="Eng. Hamza Damra" />
        <Property Id="ARPCOMMENTS" Value="Professional AI-powered background removal application" />

        <!-- Feature -->
        <Feature Id="ProductFeature" Title="Background Remover Pro" Level="1">
            <ComponentGroupRef Id="ProductComponents" />
            <ComponentRef Id="ApplicationShortcut" />
            <ComponentRef Id="DesktopShortcut" />
        </Feature>

        <!-- UI -->
        <UIRef Id="WixUI_InstallDir" />
        <WixVariable Id="WixUILicenseRtf" Value="license.rtf" />
        <WixVariable Id="WixUIBannerBmp" Value="banner.bmp" />
        <WixVariable Id="WixUIDialogBmp" Value="dialog.bmp" />

        <!-- Directory Structure -->
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder">
                <Directory Id="ManufacturerFolder" Name="Hamza Damra">
                    <Directory Id="INSTALLFOLDER" Name="Background Remover Pro" />
                </Directory>
            </Directory>
            
            <!-- Start Menu -->
            <Directory Id="ProgramMenuFolder">
                <Directory Id="ApplicationProgramsFolder" Name="Background Remover Pro"/>
            </Directory>
            
            <!-- Desktop -->
            <Directory Id="DesktopFolder" Name="Desktop" />
        </Directory>

        <!-- Start Menu Shortcut -->
        <DirectoryRef Id="ApplicationProgramsFolder">
            <Component Id="ApplicationShortcut" Guid="12345678-1234-1234-1234-123456789013">
                <Shortcut Id="ApplicationStartMenuShortcut"
                         Name="Background Remover Pro"
                         Description="AI-Powered Background Removal - المهندس حمزة ضمرة"
                         Target="[INSTALLFOLDER]BGRemover.exe"
                         WorkingDirectory="INSTALLFOLDER"
                         Icon="icon.ico"/>
                <RemoveFolder Id="CleanUpShortCut" Directory="ApplicationProgramsFolder" On="uninstall"/>
                <RegistryValue Root="HKCU" 
                              Key="Software\HamzaDamra\BGRemover" 
                              Name="installed" 
                              Type="integer" 
                              Value="1" 
                              KeyPath="yes"/>
            </Component>
        </DirectoryRef>

        <!-- Desktop Shortcut -->
        <DirectoryRef Id="DesktopFolder">
            <Component Id="DesktopShortcut" Guid="12345678-1234-1234-1234-123456789014">
                <Shortcut Id="ApplicationDesktopShortcut"
                         Name="Background Remover"
                         Description="AI Background Removal"
                         Target="[INSTALLFOLDER]BGRemover.exe"
                         WorkingDirectory="INSTALLFOLDER"
                         Icon="icon.ico"/>
                <RegistryValue Root="HKCU" 
                              Key="Software\HamzaDamra\BGRemover" 
                              Name="desktop" 
                              Type="integer" 
                              Value="1" 
                              KeyPath="yes"/>
            </Component>
        </DirectoryRef>

        <!-- Components -->
        <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
            <Component Id="MainExecutable" Guid="12345678-1234-1234-1234-123456789015">
                <File Id="BGRemoverEXE" 
                      Source="dist\BGRemover\BGRemover.exe" 
                      KeyPath="yes" 
                      Checksum="yes"/>
            </Component>
            
            <Component Id="Documentation" Guid="12345678-1234-1234-1234-123456789016">
                <File Id="README" Source="README_AR.md"/>
                <File Id="LICENSE" Source="LICENSE"/>
                <File Id="CREDITS" Source="CREDITS.md"/>
            </Component>
        </ComponentGroup>

    </Product>
</Wix>
